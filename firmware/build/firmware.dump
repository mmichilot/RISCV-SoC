
build/firmware.elf:     file format elf32-littleriscv

Contents of section .text:
 80000000 37645f00 130404e1 b7440002 37c90002  7d_......D..7...
 80000010 130989ff b7090102 130a0000 97000000  ................
 80000020 e7804002 97020000 9382c204 73905230  ..@.........s.R0
 80000030 93020008 73a04230 73600430 6f000000  ....s.B0s`.0o...
 80000040 03a50400 83a54400 b3028500 33b3a200  ......D.....3...
 80000050 63040300 b3856500 13850200 9302f0ff  c.....e.........
 80000060 23205900 2322b900 2320a900 67800000  # Y.#"..# ..g...
 80000070 f3222034 37030080 13037300 63846200  ." 47.....s.c.b.
 80000080 73002030 130a1a00 23a04901 97000000  s. 0....#.I.....
 80000090 e78040fb 73002030                    ..@.s. 0        
Contents of section .riscv.attributes:
 0000 41260000 00726973 63760001 1c000000  A&...riscv......
 0010 05727633 32693270 315f7a69 63737232  .rv32i2p1_zicsr2
 0020 70300008 010a0b                      p0.....         
Contents of section .debug_line:
 0000 fc000000 05000400 2a000000 010101fb  ........*.......
 0010 0e0d0001 01010100 00000100 00010101  ................
 0020 1f010000 00000201 1f020f02 2a000000  ............*...
 0030 002a0000 00000005 02000000 80030a01  .*..............
 0040 03010908 00010301 09040001 03010908  ................
 0050 00010301 09040001 03020904 00010303  ................
 0060 09080001 03010908 00010302 09040001  ................
 0070 03010904 00010303 09040001 03030904  ................
 0080 00010305 09040001 03010904 00010304  ................
 0090 09040001 03030904 00010301 09040001  ................
 00a0 03010904 00010303 09040001 03030904  ................
 00b0 00010301 09040001 03010904 00010301  ................
 00c0 09040001 03020904 00010303 09040001  ................
 00d0 03020904 00010301 09080001 03010904  ................
 00e0 00010304 09040001 03010904 00010301  ................
 00f0 09040001 03010908 00010904 00000101  ................
Contents of section .debug_line_str:
 0000 2f686f6d 652f6d6d 69636869 6c6f742f  /home/mmichilot/
 0010 52495343 562d6d75 6c746963 79636c65  RISCV-multicycle
 0020 2f666972 6d776172 65006669 726d7761  /firmware.firmwa
 0030 72652e53 00                          re.S.           
Contents of section .debug_info:
 0000 21000000 05000104 00000000 01000000  !...............
 0010 00000000 80980100 0000000b 00000035  ...............5
 0020 00000001 80                          .....           
Contents of section .debug_abbrev:
 0000 01110010 17110112 0f030e1b 0e250e13  .............%..
 0010 05000000                             ....            
Contents of section .debug_aranges:
 0000 1c000000 02000000 00000400 00000000  ................
 0010 00000080 98000000 00000000 00000000  ................
Contents of section .debug_str:
 0000 6669726d 77617265 2e53002f 686f6d65  firmware.S./home
 0010 2f6d6d69 6368696c 6f742f52 49534356  /mmichilot/RISCV
 0020 2d6d756c 74696379 636c652f 6669726d  -multicycle/firm
 0030 77617265 00474e55 20415320 322e3433  ware.GNU AS 2.43
 0040 2e3100                               .1.             

Disassembly of section .text:

80000000 <main>:

.text
main:
    # Since clock operates at 25 MHz, every
    # 25,000,000 cycles is 1 second
    li s0, 6250000
80000000:	005f6437          	lui	s0,0x5f6
80000004:	e1040413          	addi	s0,s0,-496 # 5f5e10 <CLINT_ADDR-0x1a0a1f0>
    la s1, MTIME_ADDR
80000008:	020044b7          	lui	s1,0x2004
    la s2, MTIMECMP_ADDR
8000000c:	0200c937          	lui	s2,0x200c
80000010:	ff890913          	addi	s2,s2,-8 # 200bff8 <MTIMECMP_ADDR>
    la s3, LEDS_ADDR
80000014:	020109b7          	lui	s3,0x2010
    li s4, 0    # Count
80000018:	00000a13          	li	s4,0

    call inc_mtimecmp
8000001c:	00000097          	auipc	ra,0x0
80000020:	024080e7          	jalr	36(ra) # 80000040 <inc_mtimecmp>

    # Setup interrupts
    la t0, isr
80000024:	00000297          	auipc	t0,0x0
80000028:	04c28293          	addi	t0,t0,76 # 80000070 <isr>
    csrw mtvec, t0  # Set mtvec to ISR
8000002c:	30529073          	csrw	mtvec,t0

    li t0, 1 << 7
80000030:	08000293          	li	t0,128
    csrs mie, t0    # Enable timer interrupt
80000034:	3042a073          	csrs	mie,t0

    # Enable global interrupts!
    csrsi mstatus, 1 << 3
80000038:	30046073          	csrsi	mstatus,8

8000003c <loop>:

loop:
    j loop
8000003c:	0000006f          	j	8000003c <loop>

80000040 <inc_mtimecmp>:

#  Subroutine to increment mtimecmp
inc_mtimecmp:
    # Get current MTIME (a1:a0)
    lw a0, 0(s1) # MTIME_LO
80000040:	0004a503          	lw	a0,0(s1) # 2004000 <MTIME_ADDR>
    lw a1, 4(s1) # MTIME_HI
80000044:	0044a583          	lw	a1,4(s1)

    # http://blog.flingos.co.uk/posts/217
    # Add MTIME_LO (a0) and count (s0) -> t0
    add t0, a0, s0
80000048:	008502b3          	add	t0,a0,s0

    # Increment MTIME_HI if there is a carry
    sltu t1, t0, a0
8000004c:	00a2b333          	sltu	t1,t0,a0
    beqz t1, no_carry
80000050:	00030463          	beqz	t1,80000058 <no_carry>
    add  a1, a1, t1
80000054:	006585b3          	add	a1,a1,t1

80000058 <no_carry>:
no_carry:
    # Put the sum back to t0
    mv a0, t0
80000058:	00028513          	mv	a0,t0

    # Set MTIMECMP
    li t0, -1
8000005c:	fff00293          	li	t0,-1
    sw t0, 0(s2)
80000060:	00592023          	sw	t0,0(s2)
    sw a1, 4(s2)
80000064:	00b92223          	sw	a1,4(s2)
    sw a0, 0(s2)
80000068:	00a92023          	sw	a0,0(s2)

    ret
8000006c:	00008067          	ret

80000070 <isr>:

isr:
    csrr t0, mcause
80000070:	342022f3          	csrr	t0,mcause

    li t1, TIMER_INT_CODE
80000074:	80000337          	lui	t1,0x80000
80000078:	00730313          	addi	t1,t1,7 # 80000007 <TIMER_INT_CODE>
    beq t0, t1, timer_int
8000007c:	00628463          	beq	t0,t1,80000084 <timer_int>
    mret
80000080:	30200073          	mret

80000084 <timer_int>:

timer_int:
    # Increment count
    addi s4, s4, 1
80000084:	001a0a13          	addi	s4,s4,1
    sw s4, 0(s3)
80000088:	0149a023          	sw	s4,0(s3) # 2010000 <LEDS_ADDR>
    call inc_mtimecmp
8000008c:	00000097          	auipc	ra,0x0
80000090:	fb4080e7          	jalr	-76(ra) # 80000040 <inc_mtimecmp>
    mret
80000094:	30200073          	mret
